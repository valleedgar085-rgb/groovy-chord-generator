<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <meta name="description" content="Create amazing chord progressions for any genre - A mobile-optimized music creation tool">
    <meta name="theme-color" content="#7c3aed">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="ChordGen">
    <meta name="mobile-web-app-capable" content="yes">
    
    <title>Groovy Chord Generator</title>
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
    
    <!-- Icons -->
    <link rel="icon" type="image/png" sizes="32x32" href="icons/icon-96x96.png">
    <link rel="apple-touch-icon" href="icons/icon-192x192.png">
    
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Onboarding Overlay -->
    <div id="onboarding-overlay" class="onboarding-overlay hidden">
        <div class="onboarding-content">
            <div class="onboarding-slide active" data-slide="0">
                <div class="onboarding-icon">üéµ</div>
                <h2>Welcome to Groovy Chord Generator!</h2>
                <p>Create amazing chord progressions for any genre in seconds.</p>
            </div>
            <div class="onboarding-slide" data-slide="1">
                <div class="onboarding-icon">üéõÔ∏è</div>
                <h2>Choose Your Style</h2>
                <p>Select a genre, complexity, and key to customize your progression.</p>
            </div>
            <div class="onboarding-slide" data-slide="2">
                <div class="onboarding-icon">üéπ</div>
                <h2>Edit & Play</h2>
                <p>Use the visual editor to fine-tune your music and hear it come to life!</p>
            </div>
            <div class="onboarding-nav">
                <div class="onboarding-dots">
                    <span class="dot active" data-dot="0"></span>
                    <span class="dot" data-dot="1"></span>
                    <span class="dot" data-dot="2"></span>
                </div>
                <button id="onboarding-next" class="btn-primary">Next</button>
                <button id="onboarding-skip" class="btn-secondary">Skip</button>
            </div>
        </div>
    </div>

    <div class="app-container">
        <!-- Sticky Header -->
        <header class="header">
            <div class="header-content">
                <h1 class="logo">üéµ ChordGen</h1>
                <button id="settings-toggle" class="header-btn" aria-label="Settings">
                    <span>‚öôÔ∏è</span>
                </button>
            </div>
        </header>

        <!-- Main Content Area with Tab Views -->
        <main class="main-content">
            <!-- Generator Tab -->
            <section id="tab-generator" class="tab-content active">
                <!-- Quick Controls - Always visible on mobile -->
                <div class="quick-controls">
                    <div class="control-row">
                        <div class="control-group compact">
                            <label for="genre-select">Genre</label>
                            <select id="genre-select">
                                <option value="happy-pop">Happy Pop</option>
                                <option value="chill-lofi">Chill Lo-Fi</option>
                                <option value="energetic-edm">EDM</option>
                                <option value="soulful-rnb">R&B</option>
                                <option value="jazz-fusion">Jazz</option>
                                <option value="dark-trap">Trap</option>
                                <option value="cinematic">Cinematic</option>
                                <option value="indie-rock">Indie Rock</option>
                            </select>
                        </div>
                        <div class="control-group compact">
                            <label for="key-select">Key</label>
                            <select id="key-select">
                                <option value="C">C Major</option>
                                <option value="G">G Major</option>
                                <option value="D">D Major</option>
                                <option value="A">A Major</option>
                                <option value="E">E Major</option>
                                <option value="F">F Major</option>
                                <option value="Bb">Bb Major</option>
                                <option value="Am">A Minor</option>
                                <option value="Em">E Minor</option>
                                <option value="Dm">D Minor</option>
                                <option value="Bm">B Minor</option>
                                <option value="Fm">F Minor</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Advanced Controls - Collapsible -->
                <div class="collapsible-section">
                    <button class="collapsible-header" aria-expanded="false">
                        <span>üéõÔ∏è Advanced Settings</span>
                        <span class="collapse-icon">‚ñº</span>
                    </button>
                    <div class="collapsible-content">
                        <div class="control-row">
                            <div class="control-group compact">
                                <label for="complexity-select">Complexity</label>
                                <select id="complexity-select">
                                    <option value="simple">Simple</option>
                                    <option value="medium" selected>Medium</option>
                                    <option value="complex">Complex</option>
                                    <option value="advanced">Advanced</option>
                                </select>
                            </div>
                            <div class="control-group compact">
                                <label for="rhythm-select">Rhythm</label>
                                <select id="rhythm-select">
                                    <option value="soft">Soft</option>
                                    <option value="moderate" selected>Moderate</option>
                                    <option value="strong">Strong</option>
                                    <option value="intense">Intense</option>
                                </select>
                            </div>
                        </div>
                        <div class="control-row music-theory-options">
                            <div class="setting-item toggle-item">
                                <label for="voice-leading">Smooth Voice Leading</label>
                                <input type="checkbox" id="voice-leading">
                            </div>
                            <div class="setting-item toggle-item">
                                <label for="advanced-theory">Advanced Theory (Spicy)</label>
                                <input type="checkbox" id="advanced-theory">
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Chord Display Section - Collapsible -->
                <div class="collapsible-section expanded">
                    <button class="collapsible-header" aria-expanded="true">
                        <span>üé∏ Chord Progression</span>
                        <span class="collapse-icon">‚ñº</span>
                    </button>
                    <div class="collapsible-content">
                        <div id="chord-display" class="chord-display">
                            <div class="chord-placeholder">Tap "Generate" to create a progression</div>
                        </div>
                    </div>
                </div>

                <!-- Melody Section - Collapsible -->
                <div class="collapsible-section">
                    <button class="collapsible-header" aria-expanded="false">
                        <span>üéπ Melody Pattern</span>
                        <span class="collapse-icon">‚ñº</span>
                    </button>
                    <div class="collapsible-content">
                        <div id="melody-display" class="melody-display">
                            <div class="melody-placeholder">Melody appears after generation</div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Editor Tab -->
            <section id="tab-editor" class="tab-content">
                <div class="editor-section">
                    <div class="editor-toolbar">
                        <div class="toolbar-group">
                            <button id="play-btn" class="toolbar-btn" aria-label="Play">
                                <span>‚ñ∂Ô∏è</span>
                                <span class="btn-label">Play</span>
                            </button>
                            <button id="stop-btn" class="toolbar-btn" aria-label="Stop">
                                <span>‚èπÔ∏è</span>
                                <span class="btn-label">Stop</span>
                            </button>
                            <button id="clear-btn" class="toolbar-btn" aria-label="Clear">
                                <span>üóëÔ∏è</span>
                                <span class="btn-label">Clear</span>
                            </button>
                        </div>
                        <div class="toolbar-group">
                            <div class="tempo-control">
                                <label for="tempo-input">BPM</label>
                                <input type="number" id="tempo-input" value="120" min="60" max="200">
                            </div>
                        </div>
                    </div>

                    <!-- Piano Roll Controls -->
                    <div class="piano-roll-controls">
                        <button id="zoom-in-btn" class="control-btn" aria-label="Zoom in">‚ûï</button>
                        <button id="zoom-out-btn" class="control-btn" aria-label="Zoom out">‚ûñ</button>
                        <button id="reset-view-btn" class="control-btn" aria-label="Reset view">üîÑ</button>
                    </div>

                    <div class="piano-roll-wrapper">
                        <div class="piano-roll-container" id="piano-roll-container">
                            <div class="piano-keys" id="piano-keys">
                                <!-- Piano keys will be generated by JS -->
                            </div>
                            <div class="piano-roll" id="piano-roll">
                                <canvas id="piano-roll-canvas"></canvas>
                            </div>
                        </div>
                    </div>
                    
                    <div class="editor-tip">
                        <span>üí°</span>
                        <p>Tap to add notes, tap again to remove. Pinch to zoom.</p>
                    </div>
                </div>
            </section>

            <!-- Settings Tab -->
            <section id="tab-settings" class="tab-content">
                <div class="settings-section">
                    <h2>Settings</h2>
                    
                    <div class="settings-group">
                        <h3>Audio</h3>
                        <div class="setting-item">
                            <label for="volume-slider">Master Volume</label>
                            <input type="range" id="volume-slider" min="0" max="100" value="80">
                        </div>
                        <div class="setting-item">
                            <label for="sound-type">Sound Type</label>
                            <select id="sound-type">
                                <option value="sine">Sine (Smooth)</option>
                                <option value="triangle">Triangle (Mellow)</option>
                                <option value="square">Square (Retro)</option>
                                <option value="sawtooth">Sawtooth (Bright)</option>
                            </select>
                        </div>
                    </div>

                    <div class="settings-group">
                        <h3>Envelope (ADSR)</h3>
                        <div class="setting-item">
                            <label for="env-attack">Attack (0 - 2s)</label>
                            <input type="range" id="env-attack" min="0" max="2" step="0.01" value="0.05">
                        </div>
                        <div class="setting-item">
                            <label for="env-decay">Decay (0 - 2s)</label>
                            <input type="range" id="env-decay" min="0" max="2" step="0.01" value="0.1">
                        </div>
                        <div class="setting-item">
                            <label for="env-sustain">Sustain (0 - 1)</label>
                            <input type="range" id="env-sustain" min="0" max="1" step="0.01" value="0.6">
                        </div>
                        <div class="setting-item">
                            <label for="env-release">Release (0 - 3s)</label>
                            <input type="range" id="env-release" min="0" max="3" step="0.01" value="0.5">
                        </div>
                    </div>

                    <div class="settings-group">
                        <h3>Display</h3>
                        <div class="setting-item toggle-item">
                            <label for="show-numerals">Show Roman Numerals</label>
                            <input type="checkbox" id="show-numerals" checked>
                        </div>
                        <div class="setting-item toggle-item">
                            <label for="show-tips">Show Tips</label>
                            <input type="checkbox" id="show-tips" checked>
                        </div>
                    </div>

                    <div class="settings-group">
                        <h3>About</h3>
                        <div class="about-info">
                            <p><strong>Groovy Chord Generator</strong></p>
                            <p>Version 2.0</p>
                            <p>Created by <span class="accent">Edgar Valle</span></p>
                            <p class="copyright">¬© 2024</p>
                        </div>
                        <button id="show-onboarding" class="btn-secondary full-width">
                            Show Tutorial
                        </button>
                    </div>
                </div>
            </section>
        </main>

        <!-- Floating Action Button -->
        <div class="fab-container">
            <button id="fab-main" class="fab" aria-label="Quick actions">
                <span class="fab-icon">üé≤</span>
            </button>
            <div class="fab-menu hidden">
                <button id="fab-generate" class="fab-action" aria-label="Generate">
                    <span>üé≤</span>
                    <span class="fab-label">Generate</span>
                </button>
                <button id="fab-regenerate" class="fab-action" aria-label="Regenerate">
                    <span>üîÑ</span>
                    <span class="fab-label">Regenerate</span>
                </button>
                <button id="fab-play" class="fab-action" aria-label="Play">
                    <span>‚ñ∂Ô∏è</span>
                    <span class="fab-label">Play</span>
                </button>
                <button id="fab-export-midi" class="fab-action" aria-label="Export MIDI">
                    <span>üíæ</span>
                    <span class="fab-label">Export MIDI</span>
                </button>
            </div>
        </div>

        <!-- Bottom Navigation -->
        <nav class="bottom-nav">
            <button class="nav-item active" data-tab="generator" aria-label="Generator">
                <span class="nav-icon">üéµ</span>
                <span class="nav-label">Generator</span>
            </button>
            <button class="nav-item" data-tab="editor" aria-label="Editor">
                <span class="nav-icon">üéº</span>
                <span class="nav-label">Editor</span>
            </button>
            <button class="nav-item" data-tab="settings" aria-label="Settings">
                <span class="nav-icon">‚öôÔ∏è</span>
                <span class="nav-label">Settings</span>
            </button>
        </nav>
    </div>

    <script src="app.js"></script>
    
    <!-- Service Worker Registration -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then((registration) => {
                        console.log('SW registered:', registration.scope);
                    })
                    .catch((error) => {
                        console.log('SW registration failed:', error);
                    });
            });
        }
    </script>
</body>
</html>
